<!DOCTYPE html>
<html lang="pl">
<head>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
<script>
    const supabase = window.supabase.createClient(
      'https://bfknyzfmhojjghhkxyrv.supabase.co',
      'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJma255emZtaG9qamdoaGt4eXJ2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDgyOTc4NTYsImV4cCI6MjA2Mzg3Mzg1Nn0.pQbR3wHdzhE4nP7PEIn5rASLNNwFa3-qKqkymDgxVLc'
    );

    async function autoSave(row) {
      if (!row || !row.cells || row.cells.length < 13) return;
      const input = (i) => row.cells[i]?.querySelector("input, select, textarea")?.value?.trim() || "";

      const dane = {
        zaladunek: input(1),
        data_zaladunku_od: row.cells[2].querySelectorAll("input")[0]?.value.trim() || "",
        data_zaladunku_do: row.cells[2].querySelectorAll("input")[1]?.value.trim() || "",
        godzina_zaladunku_od: row.cells[3].querySelectorAll("input")[0]?.value.trim() || "",
        godzina_zaladunku_do: row.cells[3].querySelectorAll("input")[1]?.value.trim() || "",
        rozladunek: input(4),
        data_rozladunku_od: row.cells[5].querySelectorAll("input")[0]?.value.trim() || "",
        data_rozladunku_do: row.cells[5].querySelectorAll("input")[1]?.value.trim() || "",
        godzina_rozladunku_od: row.cells[6].querySelectorAll("input")[0]?.value.trim() || "",
        godzina_rozladunku_do: row.cells[6].querySelectorAll("input")[1]?.value.trim() || "",
        sposob_zaladunku: input(7),
        aktualnosc: input(8),
        uwagi: input(9),
        stawka: input(10),
        kilometry: input(11),
        stawka_km: input(12)
      };

      const filled = Object.values(dane).filter(v => v !== "").length;
      if (filled < 2) return;

      if (row.dataset.id) {
        const { error } = await supabase.from("translider").update(dane).eq("id", row.dataset.id);
        if (error) console.error("Błąd aktualizacji:", error.message);
        else console.log("Zaktualizowano wiersz:", row.dataset.id);
      } else {
        const { data, error } = await supabase.from("translider").insert([dane]).select("id");
        if (error) console.error("Błąd zapisu:", error.message);
        else {
          console.log("Zapisano wiersz:", data[0]?.id);
          row.dataset.id = data[0]?.id;
        }
      }
    }

    document.addEventListener("change", (e) => {
      const row = e.target.closest("tr");
      if (row) autoSave(row);
    });

    document.addEventListener("blur", (e) => {
      const row = e.target.closest("tr");
      if (row) autoSave(row);
    }, true);

    window.addEventListener("DOMContentLoaded", async () => {
      const { data, error } = await supabase.from("translider").select("*");
      if (error) return console.error("Błąd odczytu:", error.message);

      const tabela = document.querySelector("#tabela tbody");
      data.forEach(entry => {
        const row = tabela.insertRow();
        row.dataset.id = entry.id;
        row.innerHTML = `
          <td>•</td>
          <td><input type="text" value="${entry.zaladunek || ''}"></td>
          <td><input type="date" value="${entry.data_zaladunku_od || ''}"> <input type="date" value="${entry.data_zaladunku_do || ''}"></td>
          <td><input type="time" value="${entry.godzina_zaladunku_od || ''}"> <input type="time" value="${entry.godzina_zaladunku_do || ''}"></td>
          <td><input type="text" value="${entry.rozladunek || ''}"></td>
          <td><input type="date" value="${entry.data_rozladunku_od || ''}"> <input type="date" value="${entry.data_rozladunku_do || ''}"></td>
          <td><input type="time" value="${entry.godzina_rozladunku_od || ''}"> <input type="time" value="${entry.godzina_rozladunku_do || ''}"></td>
          <td><input type="text" value="${entry.sposob_zaladunku || ''}"></td>
          <td><input type="text" value="${entry.aktualnosc || ''}"></td>
          <td><textarea>${entry.uwagi || ''}</textarea></td>
          <td><input type="number" value="${entry.stawka || ''}" step="0.01"></td>
          <td><input type="number" value="${entry.kilometry || ''}" step="1"></td>
          <td><input type="number" value="${entry.stawka_km || ''}" step="0.01"></td>
        `;
      });
    });
  </script>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
<script>
    const supabase = window.supabase.createClient(
      'https://bfknyzfmhojjghhkxyrv.supabase.co',
      'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJma255emZtaG9qamdoaGt4eXJ2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDgyOTc4NTYsImV4cCI6MjA2Mzg3Mzg1Nn0.pQbR3wHdzhE4nP7PEIn5rASLNNwFa3-qKqkymDgxVLc'
    );

    async function autoSave(row) {
      if (!row || !row.cells || row.cells.length < 13) return;
      const input = (i) => row.cells[i]?.querySelector("input, select, textarea")?.value?.trim() || "";

      const dane = {
        zaladunek: input(1),
        data_zaladunku_od: row.cells[2].querySelectorAll("input")[0]?.value.trim() || "",
        data_zaladunku_do: row.cells[2].querySelectorAll("input")[1]?.value.trim() || "",
        godzina_zaladunku_od: row.cells[3].querySelectorAll("input")[0]?.value.trim() || "",
        godzina_zaladunku_do: row.cells[3].querySelectorAll("input")[1]?.value.trim() || "",
        rozladunek: input(4),
        data_rozladunku_od: row.cells[5].querySelectorAll("input")[0]?.value.trim() || "",
        data_rozladunku_do: row.cells[5].querySelectorAll("input")[1]?.value.trim() || "",
        godzina_rozladunku_od: row.cells[6].querySelectorAll("input")[0]?.value.trim() || "",
        godzina_rozladunku_do: row.cells[6].querySelectorAll("input")[1]?.value.trim() || "",
        sposob_zaladunku: input(7),
        aktualnosc: input(8),
        uwagi: input(9),
        stawka: input(10),
        kilometry: input(11),
        stawka_km: input(12)
      };

      const filled = Object.values(dane).filter(v => v !== "").length;
      if (filled < 2) return;

      if (row.dataset.id) {
        const { error } = await supabase.from("translider").update(dane).eq("id", row.dataset.id);
        if (error) console.error("Błąd aktualizacji:", error.message);
        else console.log("Zaktualizowano wiersz:", row.dataset.id);
      } else {
        const { data, error } = await supabase.from("translider").insert([dane]).select("id");
        if (error) console.error("Błąd zapisu:", error.message);
        else {
          console.log("Zapisano wiersz:", data[0]?.id);
          row.dataset.id = data[0]?.id;
        }
      }
    }

    document.addEventListener("change", (e) => {
      const row = e.target.closest("tr");
      if (row) autoSave(row);
    });

    document.addEventListener("blur", (e) => {
      const row = e.target.closest("tr");
      if (row) autoSave(row);
    }, true);

    window.addEventListener("DOMContentLoaded", async () => {
      const { data, error } = await supabase.from("translider").select("*");
      if (error) return console.error("Błąd odczytu:", error.message);

      const tabela = document.querySelector("#tabela tbody");
      data.forEach(entry => {
        const row = tabela.insertRow();
        row.dataset.id = entry.id;
        row.innerHTML = `
          <td>•</td>
          <td><input type="text" value="${entry.zaladunek || ''}"></td>
          <td><input type="date" value="${entry.data_zaladunku_od || ''}"> <input type="date" value="${entry.data_zaladunku_do || ''}"></td>
          <td><input type="time" value="${entry.godzina_zaladunku_od || ''}"> <input type="time" value="${entry.godzina_zaladunku_do || ''}"></td>
          <td><input type="text" value="${entry.rozladunek || ''}"></td>
          <td><input type="date" value="${entry.data_rozladunku_od || ''}"> <input type="date" value="${entry.data_rozladunku_do || ''}"></td>
          <td><input type="time" value="${entry.godzina_rozladunku_od || ''}"> <input type="time" value="${entry.godzina_rozladunku_do || ''}"></td>
          <td><input type="text" value="${entry.sposob_zaladunku || ''}"></td>
          <td><input type="text" value="${entry.aktualnosc || ''}"></td>
          <td><textarea>${entry.uwagi || ''}</textarea></td>
          <td><input type="number" value="${entry.stawka || ''}" step="0.01"></td>
          <td><input type="number" value="${entry.kilometry || ''}" step="1"></td>
          <td><input type="number" value="${entry.stawka_km || ''}" step="0.01"></td>
        `;
      });
    });
  </script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
  <script>
    const supabase = window.supabase.createClient(
      'https://bfknyzfmhojjghhkxyrv.supabase.co',
      'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJma255emZtaG9qamdoaGt4eXJ2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDgyOTc4NTYsImV4cCI6MjA2Mzg3Mzg1Nn0.pQbR3wHdzhE4nP7PEIn5rASLNNwFa3-qKqkymDgxVLc'
    );

    async function autoSave(row) {
      if (!row || !row.cells || row.cells.length < 13) return;
      const input = (i) => row.cells[i]?.querySelector("input, select, textarea")?.value?.trim() || "";

      const dane = {
        zaladunek: input(1),
        data_zaladunku_od: row.cells[2].querySelectorAll("input")[0]?.value.trim() || "",
        data_zaladunku_do: row.cells[2].querySelectorAll("input")[1]?.value.trim() || "",
        godzina_zaladunku_od: row.cells[3].querySelectorAll("input")[0]?.value.trim() || "",
        godzina_zaladunku_do: row.cells[3].querySelectorAll("input")[1]?.value.trim() || "",
        rozladunek: input(4),
        data_rozladunku_od: row.cells[5].querySelectorAll("input")[0]?.value.trim() || "",
        data_rozladunku_do: row.cells[5].querySelectorAll("input")[1]?.value.trim() || "",
        godzina_rozladunku_od: row.cells[6].querySelectorAll("input")[0]?.value.trim() || "",
        godzina_rozladunku_do: row.cells[6].querySelectorAll("input")[1]?.value.trim() || "",
        sposob_zaladunku: input(7),
        aktualnosc: input(8),
        uwagi: input(9),
        stawka: input(10),
        kilometry: input(11),
        stawka_km: input(12)
      };

      const filled = Object.values(dane).filter(v => v !== "").length;
      if (filled < 2) return;

      if (row.dataset.id) {
        const { error } = await supabase.from("translider").update(dane).eq("id", row.dataset.id);
        if (error) console.error("Błąd aktualizacji:", error.message);
        else console.log("Zaktualizowano wiersz:", row.dataset.id);
      } else {
        const { data, error } = await supabase.from("translider").insert([dane]).select("id");
        if (error) console.error("Błąd zapisu:", error.message);
        else {
          console.log("Zapisano wiersz:", data[0]?.id);
          row.dataset.id = data[0]?.id;
        }
      }
    }

    document.addEventListener("change", (e) => {
      const row = e.target.closest("tr");
      if (row) autoSave(row);
    });

    document.addEventListener("blur", (e) => {
      const row = e.target.closest("tr");
      if (row) autoSave(row);
    }, true);

    window.addEventListener("DOMContentLoaded", async () => {
      const { data, error } = await supabase.from("translider").select("*");
      if (error) return console.error("Błąd odczytu:", error.message);

      const tabela = document.querySelector("#tabela tbody");
      data.forEach(entry => {
        const row = tabela.insertRow();
        row.dataset.id = entry.id;
        row.innerHTML = `
          <td>•</td>
          <td><input type="text" value="${entry.zaladunek || ''}"></td>
          <td><input type="date" value="${entry.data_zaladunku_od || ''}"> <input type="date" value="${entry.data_zaladunku_do || ''}"></td>
          <td><input type="time" value="${entry.godzina_zaladunku_od || ''}"> <input type="time" value="${entry.godzina_zaladunku_do || ''}"></td>
          <td><input type="text" value="${entry.rozladunek || ''}"></td>
          <td><input type="date" value="${entry.data_rozladunku_od || ''}"> <input type="date" value="${entry.data_rozladunku_do || ''}"></td>
          <td><input type="time" value="${entry.godzina_rozladunku_od || ''}"> <input type="time" value="${entry.godzina_rozladunku_do || ''}"></td>
          <td><input type="text" value="${entry.sposob_zaladunku || ''}"></td>
          <td><input type="text" value="${entry.aktualnosc || ''}"></td>
          <td><textarea>${entry.uwagi || ''}</textarea></td>
          <td><input type="number" value="${entry.stawka || ''}" step="0.01"></td>
          <td><input type="number" value="${entry.kilometry || ''}" step="1"></td>
          <td><input type="number" value="${entry.stawka_km || ''}" step="0.01"></td>
        `;
      });
    });
  </script>
});

document.addEventListener("blur", (e) => {
  const row = e.target.closest("tr");
  if (row && row.dataset.zapisany !== "true") autoSave(row);
}, true);
</script>


<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>










  <meta charset="UTF-8">
  <title>Platforma Załadunku i Rozładunku</title>
  <style>
    body { font-family: Arial, sans-serif; }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 6px;
      text-align: center;
    }
    .pilne { background-color: #ffe6e6; }
    .status-aktualne { background-color: #a5f3a1 !important; font-weight: bold; }
    .status-nieaktualne { background-color: #f9a1a1 !important; font-weight: bold; }
    .status-nieznane { background-color: #fff7a1 !important; font-weight: bold; }
    .date-time-group input {
      width: 45%;
      display: inline-block;
      margin: 2px 1%;
    }
    textarea { width: 100%; height: 60px; resize: vertical; }
    input[list], input[type="text"] { width: 100%; }
    #targeoMap {
      width: 100%;
      height: 500px;
      margin-top: 30px;
      border: none;
    }
  </style>


<script>
    const supabase = window.supabase.createClient(
      'https://bfknyzfmhojjghhkxyrv.supabase.co',
      'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJma255emZtaG9qamdoaGt4eXJ2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDgyOTc4NTYsImV4cCI6MjA2Mzg3Mzg1Nn0.pQbR3wHdzhE4nP7PEIn5rASLNNwFa3-qKqkymDgxVLc'
    );

    async function autoSave(row) {
      if (!row || !row.cells || row.cells.length < 13) return;
      const input = (i) => row.cells[i]?.querySelector("input, select, textarea")?.value?.trim() || "";

      const dane = {
        zaladunek: input(1),
        data_zaladunku_od: row.cells[2].querySelectorAll("input")[0]?.value.trim() || "",
        data_zaladunku_do: row.cells[2].querySelectorAll("input")[1]?.value.trim() || "",
        godzina_zaladunku_od: row.cells[3].querySelectorAll("input")[0]?.value.trim() || "",
        godzina_zaladunku_do: row.cells[3].querySelectorAll("input")[1]?.value.trim() || "",
        rozladunek: input(4),
        data_rozladunku_od: row.cells[5].querySelectorAll("input")[0]?.value.trim() || "",
        data_rozladunku_do: row.cells[5].querySelectorAll("input")[1]?.value.trim() || "",
        godzina_rozladunku_od: row.cells[6].querySelectorAll("input")[0]?.value.trim() || "",
        godzina_rozladunku_do: row.cells[6].querySelectorAll("input")[1]?.value.trim() || "",
        sposob_zaladunku: input(7),
        aktualnosc: input(8),
        uwagi: input(9),
        stawka: input(10),
        kilometry: input(11),
        stawka_km: input(12)
      };

      const filled = Object.values(dane).filter(v => v !== "").length;
      if (filled < 2) return;

      if (row.dataset.id) {
        const { error } = await supabase.from("translider").update(dane).eq("id", row.dataset.id);
        if (error) console.error("Błąd aktualizacji:", error.message);
        else console.log("Zaktualizowano wiersz:", row.dataset.id);
      } else {
        const { data, error } = await supabase.from("translider").insert([dane]).select("id");
        if (error) console.error("Błąd zapisu:", error.message);
        else {
          console.log("Zapisano wiersz:", data[0]?.id);
          row.dataset.id = data[0]?.id;
        }
      }
    }

    document.addEventListener("change", (e) => {
      const row = e.target.closest("tr");
      if (row) autoSave(row);
    });

    document.addEventListener("blur", (e) => {
      const row = e.target.closest("tr");
      if (row) autoSave(row);
    }, true);

    window.addEventListener("DOMContentLoaded", async () => {
      const { data, error } = await supabase.from("translider").select("*");
      if (error) return console.error("Błąd odczytu:", error.message);

      const tabela = document.querySelector("#tabela tbody");
      data.forEach(entry => {
        const row = tabela.insertRow();
        row.dataset.id = entry.id;
        row.innerHTML = `
          <td>•</td>
          <td><input type="text" value="${entry.zaladunek || ''}"></td>
          <td><input type="date" value="${entry.data_zaladunku_od || ''}"> <input type="date" value="${entry.data_zaladunku_do || ''}"></td>
          <td><input type="time" value="${entry.godzina_zaladunku_od || ''}"> <input type="time" value="${entry.godzina_zaladunku_do || ''}"></td>
          <td><input type="text" value="${entry.rozladunek || ''}"></td>
          <td><input type="date" value="${entry.data_rozladunku_od || ''}"> <input type="date" value="${entry.data_rozladunku_do || ''}"></td>
          <td><input type="time" value="${entry.godzina_rozladunku_od || ''}"> <input type="time" value="${entry.godzina_rozladunku_do || ''}"></td>
          <td><input type="text" value="${entry.sposob_zaladunku || ''}"></td>
          <td><input type="text" value="${entry.aktualnosc || ''}"></td>
          <td><textarea>${entry.uwagi || ''}</textarea></td>
          <td><input type="number" value="${entry.stawka || ''}" step="0.01"></td>
          <td><input type="number" value="${entry.kilometry || ''}" step="1"></td>
          <td><input type="number" value="${entry.stawka_km || ''}" step="0.01"></td>
        `;
      });
    });
  </script>





<script>
async function wczytajDaneZSupabase() {
  const { data, error } = await supabase.from("translider").select("*");

  if (error) {
    console.error("❌ Błąd pobierania danych:", error.message);
    return;
  }

  if (!data || data.length === 0) {
    console.log("ℹ️ Brak danych do wyświetlenia.");
    return;
  }

  const tabela = document.querySelector("#tabela tbody");
  tabela.innerHTML = "";

  data.forEach(record => {
    const row = dodajWiersz();
    row.dataset.id = record.id;

    const wpisz = (i, val) => {
      const el = row.cells[i]?.querySelector("input, select, textarea");
      if (el) el.value = val || "";
    };

    wpisz(1, record.zaladunek);
    row.cells[2].querySelectorAll("input")[0].value = record.data_zaladunku_od || "";
    row.cells[2].querySelectorAll("input")[1].value = record.data_zaladunku_do || "";
    row.cells[3].querySelectorAll("input")[0].value = record.godzina_zaladunku_od || "";
    row.cells[3].querySelectorAll("input")[1].value = record.godzina_zaladunku_do || "";
    wpisz(4, record.rozladunek);
    row.cells[5].querySelectorAll("input")[0].value = record.data_rozladunku_od || "";
    row.cells[5].querySelectorAll("input")[1].value = record.data_rozladunku_do || "";
    row.cells[6].querySelectorAll("input")[0].value = record.godzina_rozladunku_od || "";
    row.cells[6].querySelectorAll("input")[1].value = record.godzina_rozladunku_do || "";
    row.cells[7].querySelector("select").value = record.sposob_zaladunku || "";
    row.cells[8].querySelector("select").value = record.aktualnosc || "";
    row.cells[9].querySelector("textarea").value = record.uwagi || "";
    wpisz(10, record.stawka);
    wpisz(11, record.kilometry);
    wpisz(12, record.stawka_km);

    const statusSelect = row.cells[8].querySelector("select");
    if (statusSelect) zmienAktualnosc(statusSelect);
  });
}
</script>


<script>
  document.addEventListener("DOMContentLoaded", () => {
    wczytajDaneZSupabase();
  });
</script>

</body>
</html>
